Description: Override upstream copy and use libbsd
  Avoid using local copy of strlcpy, use the libbsd library in overlay mode
  instead on our supported targets.
Author: Yuri D'Elia <wavexx@thregr.org>
Forwarded: not-needed
Updated: 2020-01-29

--- a/Makefile.linux
+++ b/Makefile.linux
@@ -1,5 +1,7 @@
-CPPFLAGS += -D_GNU_SOURCE -D_LINUX_PORT -Imissing
+PKG_CONFIG ?= pkg-config
+CFLAGS += -D_GNU_SOURCE -D_LINUX_PORT $(shell $(PKG_CONFIG) --cflags libbsd-overlay) -Imissing
+LDFLAGS += -lpthread $(shell $(PKG_CONFIG) --libs libbsd-ctor)
 MANPREFIX ?= ${PREFIX}/share/man
-EXTRA_SRC = missing/strlcpy.c missing/kqueue_inotify.c
+EXTRA_SRC = missing/kqueue_inotify.c
 
 include Makefile.bsd
--- a/missing/compat.h
+++ b/missing/compat.h
@@ -4,7 +4,7 @@
 #define NOTE_TRUNCATE 0
 #endif
 
-#if defined(_LINUX_PORT) && defined(__GLIBC__)
+#if defined(_LINUX_PORT) && defined(__GLIBC__) && !defined(LIBBSD_OVERLAY)
 #include <sys/types.h>
 size_t strlcpy(char *to, const char *from, int l);
 #endif
